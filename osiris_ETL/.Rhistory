library(tidyr)
library(readxl)
# Import and clean data
datafile <- '../_data/'
version
version
library(tidyr)
library(readxl)
# Import and clean data
datafile <- '../_data/'
datafile <- '../_data/Bank_Financials_Downloaded_22Jul2018.xlsx'
raw_data <- read_excel(datafile)
warnings()
View(raw_data)
raw_data
View(raw_data)
raw_data %>%
group_by(`Company Fiscal Year End (SAS Date Format)`) %>%
summarise(count=n_distinct(`OSIRIS Identification Number`))
library(tidyr)
library(readxl)
raw_data %>%
group_by(`Company Fiscal Year End (SAS Date Format)`) %>%
summarise(count=n_distinct(`OSIRIS Identification Number`))
test <- raw_data %>%
group_by(`Company Fiscal Year End (SAS Date Format)`) %>%
summarise(count=n_distinct(`OSIRIS Identification Number`))
test <- raw_data %>%
summarise(count=n_distinct(`OSIRIS Identification Number`))
test <- raw_data %>%
summarise(count=n_distinct(`OSIRIS Identification Number`))
library(tidyverse)
library(readxl)
raw_data %>%
group_by(`Company Fiscal Year End (SAS Date Format)`) %>%
summarise(count=n_distinct(`OSIRIS Identification Number`))
raw_data %>%
mutate(`Company Fiscal Year End (SAS Date Format)`
= parse_date(`Company Fiscal Year End (SAS Date Format)`,
"%Y-%m-%d")) %>%
group_by(`Company Fiscal Year End (SAS Date Format)`) %>%
summarise(count=n_distinct(`OSIRIS Identification Number`))
raw_data %>%
mutate(`Company Fiscal Year End (SAS Date Format)`
= parse_date(`Company Fiscal Year End (SAS Date Format)`,
"%Y-%m-%d")) %>%
mutate(year = format(`Company Fiscal Year End (SAS Date Format)`,
"%Y")) %>%
group_by(year) %>%
summarise(count=n_distinct(`OSIRIS Identification Number`))
ggplot(data = summary_distinct) %>%
geom_line(aes(x=year, y=count))
summary_distinct <- raw_data %>%
mutate(`Company Fiscal Year End (SAS Date Format)`
= parse_date(`Company Fiscal Year End (SAS Date Format)`,
"%Y-%m-%d")) %>%
mutate(year = format(`Company Fiscal Year End (SAS Date Format)`,
"%Y")) %>%
group_by(year) %>%
summarise(count=n_distinct(`OSIRIS Identification Number`))
ggplot(data = summary_distinct) %>%
geom_line(aes(x=year, y=count))
summary_distinct
ggplot(data = summary_distinct) %>%
geom_line(aes(x=year, y=count))
ggplot(data = summary_distinct) %>%
geom_line(aes(year, count))
ggplot(data = summary_distinct, aes(year, count)) %>%
geom_line()
colnames(summary_distinct)
ggplot(data=summary_distinct) +
geom_line(aes(year, count))
summary_distinct <- raw_data %>%
mutate(`Company Fiscal Year End (SAS Date Format)`
= parse_date(`Company Fiscal Year End (SAS Date Format)`,
"%Y-%m-%d")) %>%
mutate(year = format(`Company Fiscal Year End (SAS Date Format)`,
"%Y")) %>%
group_by(year)
ggplot(data=summary_distinct) +
geom_line(aes(year, n()), group=)
ggplot(data=summary_distinct) +
geom_line(aes(year, n()), group=year)
summary_distinct <- raw_data %>%
mutate(`Company Fiscal Year End (SAS Date Format)`
= parse_date(`Company Fiscal Year End (SAS Date Format)`,
"%Y-%m-%d")) %>%
mutate(year = format(`Company Fiscal Year End (SAS Date Format)`,
"%Y"))
ggplot(data=summary_distinct) +
geom_line(aes(year, n()), group=year)
summary_distinct
summary_distinct$year
summary_distinct <- raw_data %>%
mutate(`Company Fiscal Year End (SAS Date Format)`
= parse_date(`Company Fiscal Year End (SAS Date Format)`,
"%Y-%m-%d")) %>%
mutate(year = format(`Company Fiscal Year End (SAS Date Format)`,
"%Y")) %>%
group_by(year) %>%
summarise(count=n_distinct(`OSIRIS Identification Number`))
ggplot(data=summary_distinct) +
geom_line(aes(year, count)
)
ggplot(data=summary_distinct) +
geom_line(aes(year, count, group=1))
selected_data <- cleaned_data %>%
select(vars) %>%
filter(`OSIRIS Identification Number` %in% banks)
cleaned_data <- raw_data
selected_data <- cleaned_data %>%
select(vars) %>%
filter(`OSIRIS Identification Number` %in% banks)
banks <- c(
'AE21860',
'AE30958',
'AE33331'
)
vars <- c(
'ISIN No',
'Company name',
'Main exchange'
)
# Select and output the relevant data
selected_data <- cleaned_data %>%
select(vars) %>%
filter(`OSIRIS Identification Number` %in% banks)
selected_data <- cleaned_data %>%
select(vars)
View(selected_data)
selected_data <- cleaned_data %>%
filter(`OSIRIS Identification Number` %in% banks) %>%
select(vars)
write_csv(selected_data, 'selected_data.csv')
raw_data %>%
group_by(`Company name`, `OSIRIS Identification Number`) %>%
arrange(`Company name`) %>%
write_csv(path='lookuptable.csv')
companies <- raw_data %>%
group_by(`Company name`, `OSIRIS Identification Number`) %>%
arrange(`Company name`)
companies <- raw_data %>%
group_by(`Company name`, `OSIRIS Identification Number`) %>%
select(`Company name`, `OSIRIS Identification Number`) %>%
arrange(`Company name`)
View(companies)
companies <- raw_data %>%
summarise(`Company name`, `OSIRIS Identification Number`)
companies <- raw_data %>%
group_by(`Company name`, `OSIRIS Identification Number`) %>%
summarise(count=n()) %>%
arrange(`Company name`)
companies <- raw_data %>%
group_by(`Company name`, `OSIRIS Identification Number`) %>%
summarise(count_records=n())
companies <- cleaned_data %>%
group_by(`Company name`, `OSIRIS Identification Number`) %>%
summarise(count_records=n())
write_csv(companies, path='lookuptable.csv')
rm(list=l())
rm(list=ls())
library(tidyverse)
library(readxl)
# Import and clean data
datafile <- '../_data/Bank_Financials_Downloaded_22Jul2018.xlsx'
raw_data <- read_excel(datafile)
cleaned_data <- raw_data
# Create a lookup table
companies <- cleaned_data %>%
group_by(`Company name`, `OSIRIS Identification Number`) %>%
summarise(count_records=n())
write_csv(companies, path='lookuptable.csv')
# Specify desired banks and variables
banks <- c(
'AE21860',
'AE30958',
'AE33331'
)
vars <- c(
'ISIN No',
'Company name',
'Main exchange'
)
# Select and output the relevant data
selected_data <- cleaned_data %>%
filter(`OSIRIS Identification Number` %in% banks) %>%
select(vars)
write_csv(selected_data, 'selected_data.csv')
